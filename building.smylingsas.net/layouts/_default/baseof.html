<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">
    <head>
        {{ partial "head.html" . }}
    </head>
    <body>
        <div class="app-layout">
            <header class="header">
                {{ partial "header.html" . }} 
            </header>
            <nav class="sidebar">
                {{ partial "nav.html" . }}
            </nav>
            <main class="main">
                {{- block "main" . -}}{{- end -}}
            </main>
        </div>
        {{/*  {{- partial "search.html" . -}}  */}}

        <dialog id="batteryInfoModal">
  <div class="modal-content">
    <h2>Batteriinformasjon</h2>
    <table id="battery-information">
            <tr>
                <th>Battery information</th>
                <th>Value</th>
            </tr>
            <tr>
                <td>Plugged in? (yes/no)</td>
                <td id="battery-charging"></td>
            </tr>
            <tr>
                <td>Battery level</td>
                <td id="battery-level"> </td>
            </tr>
            <tr>
                <td>Time remaining to fully charged battery</td>
                <td id="battery-chargetime"> </td>
            </tr>
            <tr>
                <td>Time remaining to empty battery</td>
                <td id="battery-dischargetime"></td>
            </tr>
        </table>
    <button class="close-modal">Close</button>
  </div>
  
        <script>
            navigator.getBattery().then((battery) => {
                function updateAllBatteryInfo() {
                    updateChargeInfo();
                    updateLevelInfo();
                    updateChargingInfo();
                    updateDischargingInfo();
                }
                updateAllBatteryInfo();

                battery.addEventListener("chargingchange", () => {
                    updateChargeInfo();
                });

                function updateChargeInfo() {
                    let batteryCharging = document.getElementById('battery-charging')
                    batteryCharging.innerText = `${battery.charging ? "yes" : "no"}`
                }

                battery.addEventListener("levelchange", () => {
                    updateLevelInfo();
                });

                function updateLevelInfo() {
                    let batteryLevel = document.getElementById('battery-level')
                    batteryLevel.innerText = `${battery.level * 100}%`
                }

                battery.addEventListener("chargingtimechange", () => {
                    updateChargingInfo();
                });

                function updateChargingInfo() {
                    let batteryChargetime = document.getElementById('battery-chargetime')
                    batteryChargetime.innerText = `${battery.chargingTime} sec`
                }

                battery.addEventListener("dischargingtimechange", () => {
                    updateDischargingInfo();
                });

                function updateDischargingInfo() {
                    let batteryDischargetime = document.getElementById('battery-dischargetime')
                    batteryDischargetime.innerText = `${battery.dischargingTime} sec`
                }
            });
        </script>
</dialog>

<dialog id="networkInfoModal">
  <div class="modal-content">
    <h2>Netverksinfo</h2>
    <table id="network-information">
            <tr>
                <th>Network information</th>
                <th>Value</th>
            </tr>
            <tr>
                <td>Effective bandwidth (mbit/s)</td>
                <td id="network-downlink"> </td>
            </tr>
            <tr>
                <td>Effective type of the connection</td>
                <td id="network-effetive-type"> </td>
            </tr>
            <tr>
                <td>Round-trip time of the current connection (RTT)</td>
                <td id="network-rtt"> </td>
            </tr>
            <tr>
                <td>User has set a reduced data usage option</td>
                <td id="network-save-data"></td>
            </tr>
        </table>
    <button class="close-modal">Close</button>
  </div>
  <script>
            const connection = navigator.connection;
            if(connection) {
                const downlink = document.getElementById('network-downlink')
                downlink.innerText = connection.downlink

                const effectiveType = document.getElementById('network-effetive-type')
                effectiveType.innerText = connection.effectiveType

                const rtt = document.getElementById('network-rtt')
                rtt.innerText = connection.rtt

                const saveData = document.getElementById('network-save-data')
                saveData.innerText = connection.saveData
            }
        </script>
</dialog>
        {{ partial "scripts.html" . }}
    </body>
</html>